check code at https://github.com/cucicov/CC3
